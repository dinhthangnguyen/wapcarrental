<form id ="verify-form">
    <h2>Information</h2>
    <div class="form-group">
        <label for="email" class="form-label mt-4 ">Email address</label>
        <input type="email" class="form-control" id="email"
            aria-describedby="emailHelp" placeholder="Enter email">
    </div>
    <div class="form-group">
        <label for="name" class="form-label mt-4">Name</label>
        <input type="text" class="form-control" id="name" placeholder="Enter Name">
    </div>
    <div class="form-group">
        <label for="phone" class="form-label mt-4">Phone</label>
        <input type="tel" class="form-control" id="phone" placeholder="Enter Phone">
    </div>
    <div class="form-group">
        <label for="billingAddress" class="form-label mt-4">Billing Address</label>
        <input type="text" class="form-control" id="billingAddress" placeholder="Enter Billing Address">
    </div>
    <div class="form-group">
        <label for="creditCard" class="form-label mt-4">Credit Card</label>
        <input type="tel" class="form-control" id="creditCard" placeholder="Enter Credit Card">
    </div>
    <div class="form-group">
        <label for="zip" class="form-label mt-4">Zip</label>
        <input type="tel" class="form-control" id="zip" placeholder="Enter Zip">
    </div>
    <button type="submit" id="btnUpdate" class="btn btn-primary">Update</button>
    <button type="button" id="btnmanagecar" class="btn btn-primary">Manage cars</button>
</form>
<script>
    async function loadData() {
        const pathname = window.location.pathname;
        let paths = pathname.split("/");
        let id = paths[2];

        let response = await fetch(`http://localhost:3000/owners/api/${id}`);
        if(response.ok){
            let owner = await response.json();
            document.getElementById('email').value = owner.email;
            document.getElementById('name').value = owner.name;
            document.getElementById('phone').value = owner.phone;
            document.getElementById('billingAddress').value = owner.billingAddress;
            document.getElementById('creditCard').value = owner.creditCard;
            document.getElementById('zip').value = owner.zip;

        }
    }

    async function updateOwner(id, name, phone, billingAddress, zip, email, creditCard) {
    let obj = { id, name, phone, billingAddress, zip, email, creditCard };
    let setting = {
        method: "PUT",
        body: JSON.stringify(obj),
        headers: { "Content-Type": 'application/json' }
    }
    let response = await fetch(`http://localhost:3000/owners/api/${id}`, setting);
    if (response.ok) {
        alert("Update Successfull");
    } else alert("Error " + response.status);
}

    document.getElementById('btnUpdate').addEventListener("click", () => {
        // Prevent the default form submission behavior
        if (!document.getElementById('verify-form').checkValidity()) {
            return;
        }
        event.preventDefault();

        const pathname = window.location.pathname;
        let paths = pathname.split("/");
        let id = paths[2];

        let email = document.getElementById('email').value;
        let name = document.getElementById('name').value;
        let phone = document.getElementById('phone').value;
        let billingAddress = document.getElementById('billingAddress');
        let creditCard = document.getElementById('creditCard').value;
        let zip = document.getElementById('zip').value;

        updateOwner(id, name, phone, billingAddress, zip, email, creditCard);
    })

    window.onload = loadData;
</script>